{"version":3,"sources":["components/NodeName.js","components/SearchBar/NodeRow.js","constants/spreadsheet_endpoints.js","components/SearchBar/component.js","components/SearchBar/connected.js","actions/index.js","utils/index.js","components/MapView/Sector.js","components/MapView/NodeMarker.js","components/MapView/KioskMarker.js","components/MapView/LinkLine.js","components/NodeDetail/component.js","components/NodeDetail/connected.js","components/Gallery/component.js","components/Gallery/connected.js","components/MapView/component.js","components/MapView/styles.js","components/MapView/connected.js","components/Filters/component.js","components/Filters/connected.js","components/Stats/component.js","components/Stats/connected.js","components/Log/component.js","components/Log/connected.js","reducers/index.js","App.js","index.js"],"names":["icons","dead","react_default","a","createElement","xmlns","width","height","cx","cy","r","stroke","strokeWidth","fill","opacity","potential","potential-hub","potential-supernode","active","remote","kiosk","omni","hub","supernode","linkNYC","NodeName","_this$props","this","props","node","search","name","concat","id","className","type","main_default","highlightClassName","searchWords","autoEscape","textToHighlight","notes","PureComponent","NodeRow","onClick","Link","to","key","NodeName_NodeName","sheetsNodeDataSeattle","SearchBar","state","filteredNodes","showDropdown","focused","keyDownHandler","handleKeyDown","bind","window","addEventListener","removeEventListener","event","history","_this$state","keyCode","length","push","setState","refs","blur","prevProps","prevState","nodes","filterSearch","renderSearchBar","renderList","_this2","toggleFilters","focus","viewBox","strokeLinecap","strokeLinejoin","style","minWidth","x1","y1","x2","y2","ref","value","placeholder","spellCheck","autoCorrect","onFocus","onBlur","onChange","target","renderClearButton","stopPropagation","_this3","map","NodeRow_NodeRow","_this4","lowerSearch","toLowerCase","Object","toConsumableArray","filter","parseInt","notesMatch","indexOf","nameMatches","sort","b","status","withRouter","connect","ownProps","tickets","dispatch","PureSearchBar","nodeColors","sector","backbone","sectorColors","default","visibilityMultipliers","highlight","secondary","dim","zIndexes","Sector","visibility","filters","_sector$node$coordina","slicedToArray","coordinates","lng","lat","radius","azimuth","visibilityMultiplier","multiplier","undefined","intervalCount","Math","ceil","fillOpacity","fillColor","getFillColor","zIndex","interval","Array","keys","index","path","centerPoint","PRlat","PI","PRlng","cos","PGpoints","lat1","lon1","sin","lat2","lon2","theta","gamma","PGlon","PGlat","getPath","lib","options","strokeColor","strokeOpacity","clickable","_this$props2","NodeMarker","prefix","visible","memberNodes","_coordinates","title","n","join","_this$getMarkerProps","getMarkerProps","icon","adjustedZ","getZIndex","getOpacity","console","log","react","defaultPosition","defaultTitle","renderSectors","sectors","Sector_Sector","defaultZIndex","_this$props3","url","anchor","x","y","VisibilityMarker","NodeMarker_NodeMarker","assign","KioskMarker","_kiosk$coordinates","LinkLine","link","fromNode","toNode","_fromNode$coordinates","lng1","_toNode$coordinates","lng2","latlng1","latlng2","_this$getLineProps","getLineProps","strokeWeight","defaultOpacity","isBackbone","bonus","getPixelPositionOffset","NodeDetail","nodeId","nodesById","position","google","maps","LatLng","mapPaneName","OverlayView","OVERLAY_MOUSE_TARGET","preventMapHitsFrom","renderImage","version","aria-hidden","fillRule","d","panoramas","firstPanorama","backgroundImage","Gallery","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","getPanoramas","preventDefault","match","_match$params","params","panoId","panoIdInt","nextPanoId","prevPanoId","_match$params2","src","react_document_title_default","open","alt","renderPreviews","_match$params3","panorama","PureGallery","DEFAULT_CENTER","styles","elementType","stylers","featureType","fullscreenControl","streetViewControl","zoomControlOptions","mapTypeControlOptions","backgroundColor","gestureHandling","clickableIcons","MapComponent","withScriptjs","withGoogleMap","mapRef","children","MapView","commandPressed","React","createRef","markerRefs","lineRefs","lastDoubleClick","Date","now","keyUpHandler","handleKeyUp","setTimeout","handleSelectedChange","e","error","nextProps","nodesChanged","isEqual","matchChanged","filtersChanged","resetAllNodes","nextSelectedMarkers","selectedNodeIds","m","nextSelectedNodes","marker","updateNodes","updateLinks","panToNodes","defaultZoom","defaultCenter","defaultOptions","onDblClick","loadingElement","containerElement","mapElement","googleMapURL","renderLinks","renderKiosks","renderNodes","renderNodeDetail","es_Route","exact","component","_this5","_nodes","selectedIds","reduce","idMap","objectSpread","defineProperty","isFiltered","isSelected","neighborIsSelected","links","forEach","from","NodeMarker_VisibilityMarker","handleNodeClick","handleMarkerRef","_this6","LinkLine_LinkLine","linkId","handleLineRef","kiosks","KioskMarker_KioskMarker","nodeIds","nodeTitles","NodeDetail_connected","selectedId","toString","newNodeIds","newNodeIdString","uniq","replace","_this7","ReactDOM","unstable_batchedUpdates","values","setVisibility","line","selectedNodes","markers","_this8","connectedNodes","connectedMarker","_this9","fitBounds","minLng","minLat","maxLng","maxLat","_node$coordinates","newBounds","east","north","south","west","current","innerWidth","panToBounds","_nodes$0$coordinates","panTo","arguments","split","Component","PureMapView","labels","Filters","toggleFilter","URLSearchParams","location","get","showFilters","role","label","renderFilter","hideCount","statusCounts","enabled","htmlFor","color","getColor","marginLeft","marginRight","marginTop","marginBottom","getIcon","getLabel","defaultChecked","PureFilters","Stats","_statusCounts$active","_statusCounts$hub","_statusCounts$superno","_statusCounts$omni","_statusCounts$remote","_statusCounts$kiosk","totalCount","nodeCount","hubCount","Log","limit","sortedLinks","installDate","slice","scroll","format","renderHorizontalLink","initialFilters","changelog","processEntry","_callee2","entity","flattened","regenerator_default","wrap","_context2","prev","next","flat","abrupt","stop","populateSpreadsheet","_callee3","_context3","fetch","then","res","json","feed","entry","jsonEntries","rowMap","1","2","3","4","5","6","formattedEntry","formattedEntries","i","column","gs$cell","col","content","$t","newStatus","parseFloat","unshift","requestDate","catch","err","addGraphData","linksByNodeId","mergedNodes","String","nodeStatus","geoKey","linkStatus","sectorsByNodeId","lowerNotes","isSupernode","isHub","notPotentialHub","isOmni","isKiosk","isRemote","hasPanoramas","nodeType","getCounts","counts","toFixed","reducerInit","_ref","asyncToGenerator","mark","_callee","nodeData","_addGraphData","_context","sent","linkData","sectorData","action","newFilters","newValue","apply","StoreLoaded","store","es","BrowserRouter","basename","connected","Route","_ref2","MapView_connected","App","reducer","createStore","require","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.160beb2a.chunk.js","sourcesContent":["import React, { PureComponent } from \"react\";\r\nimport Highlighter from \"react-highlight-words\";\r\n\r\nexport const icons = {\r\n\tdead: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\">\r\n\t\t\t<circle\r\n\t\t\t\tcx=\"7\"\r\n\t\t\t\tcy=\"7\"\r\n\t\t\t\tr=\"5\"\r\n\t\t\t\tstroke=\"#fff\"\r\n\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\tfill=\"#aaa\"\r\n\t\t\t\topacity=\"1\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\tpotential: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\">\r\n\t\t\t<circle\r\n\t\t\t\tcx=\"8\"\r\n\t\t\t\tcy=\"8\"\r\n\t\t\t\tr=\"6\"\r\n\t\t\t\tstroke=\"#fff\"\r\n\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\tfill=\"#777\"\r\n\t\t\t\topacity=\"1\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\t\"potential-hub\": (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"22\">\r\n\t\t\t<circle\r\n\t\t\t\tfill=\"#777\"\r\n\t\t\t\tstroke=\"white\"\r\n\t\t\t\tr=\"8\"\r\n\t\t\t\tstrokeWidth=\"3\"\r\n\t\t\t\tcy=\"11\"\r\n\t\t\t\tcx=\"11\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\t\"potential-supernode\": (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\r\n\t\t\t<g>\r\n\t\t\t\t<circle\r\n\t\t\t\t\topacity=\"1\"\r\n\t\t\t\t\tfill=\"#777\"\r\n\t\t\t\t\tstrokeWidth=\"4\"\r\n\t\t\t\t\tstroke=\"#fff\"\r\n\t\t\t\t\tr=\"10\"\r\n\t\t\t\t\tcy=\"14\"\r\n\t\t\t\t\tcx=\"14\"\r\n\t\t\t\t/>\r\n\t\t\t</g>\r\n\t\t</svg>\r\n\t),\r\n\tactive: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\">\r\n\t\t\t<circle\r\n\t\t\t\tfill=\"rgb(255,45,85)\"\r\n\t\t\t\tstroke=\"white\"\r\n\t\t\t\tr=\"6\"\r\n\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\tcx=\"8\"\r\n\t\t\t\tcy=\"8\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\tremote: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\">\r\n\t\t\t<circle\r\n\t\t\t\tfill=\"rgb(255,45,85)\"\r\n\t\t\t\tstroke=\"white\"\r\n\t\t\t\tr=\"6\"\r\n\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\tcx=\"8\"\r\n\t\t\t\tcy=\"8\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\tkiosk: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\">\r\n\t\t\t<circle\r\n\t\t\t\tfill=\"rgb(255,45,85)\"\r\n\t\t\t\tstroke=\"white\"\r\n\t\t\t\tr=\"6\"\r\n\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\tcx=\"8\"\r\n\t\t\t\tcy=\"8\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\tomni: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\">\r\n\t\t\t<circle\r\n\t\t\t\tfill=\"rgb(90,200,250)\"\r\n\t\t\t\tstroke=\"white\"\r\n\t\t\t\tr=\"6\"\r\n\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\tcx=\"8\"\r\n\t\t\t\tcy=\"8\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\thub: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"22\">\r\n\t\t\t<circle\r\n\t\t\t\tfill=\"rgb(90,200,250)\"\r\n\t\t\t\tstroke=\"white\"\r\n\t\t\t\tr=\"8\"\r\n\t\t\t\tstrokeWidth=\"3\"\r\n\t\t\t\tcy=\"11\"\r\n\t\t\t\tcx=\"11\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t),\r\n\tsupernode: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\r\n\t\t\t<g>\r\n\t\t\t\t<circle\r\n\t\t\t\t\topacity=\"1\"\r\n\t\t\t\t\tfill=\"#007aff\"\r\n\t\t\t\t\tstrokeWidth=\"4\"\r\n\t\t\t\t\tstroke=\"#fff\"\r\n\t\t\t\t\tr=\"10\"\r\n\t\t\t\t\tcy=\"14\"\r\n\t\t\t\t\tcx=\"14\"\r\n\t\t\t\t/>\r\n\t\t\t</g>\r\n\t\t</svg>\r\n\t),\r\n\tlinkNYC: (\r\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\r\n\t\t\t<circle\r\n\t\t\t\tcx=\"10\"\r\n\t\t\t\tcy=\"10\"\r\n\t\t\t\tr=\"3\"\r\n\t\t\t\tstroke=\"white\"\r\n\t\t\t\tstrokeWidth=\"0\"\r\n\t\t\t\tfill=\"#01a2eb\"\r\n\t\t\t\topacity=\"1\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t)\r\n};\r\n\r\nexport default class NodeName extends PureComponent {\r\n\trender() {\r\n\t\tconst { node, search } = this.props;\r\n\t\tconst name = node.name || `Node ${node.id}`;\r\n\t\treturn (\r\n\t\t\t<div className=\"h1 w-100 overflow-visible flex justify-start items-center\">\r\n\t\t\t\t<div className=\"h2 w2 min-h2 min-w2 flex items-center justify-center\">\r\n\t\t\t\t\t{icons[node.type]}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"pl1 flex-1 truncate\">\r\n\t\t\t\t\t<span className=\"db f5 fw6 black mv0\">\r\n\t\t\t\t\t\t<Highlighter\r\n\t\t\t\t\t\t\thighlightClassName=\"bg-light-yellow\"\r\n\t\t\t\t\t\t\tsearchWords={[search]}\r\n\t\t\t\t\t\t\tautoEscape={true}\r\n\t\t\t\t\t\t\ttextToHighlight={name}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t{node.notes ? (\r\n\t\t\t\t\t\t<span className=\"db f7 gray mv05 truncate\">\r\n\t\t\t\t\t\t\t<Highlighter\r\n\t\t\t\t\t\t\t\thighlightClassName=\"bg-light-yellow dark-gray\"\r\n\t\t\t\t\t\t\t\tsearchWords={[search]}\r\n\t\t\t\t\t\t\t\tautoEscape={true}\r\n\t\t\t\t\t\t\t\ttextToHighlight={node.notes}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t) : null}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { PureComponent } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport NodeName from \"../NodeName\";\r\n\r\nexport default class NodeRow extends PureComponent {\r\n\trender() {\r\n\t\tconst { node, search, onClick } = this.props;\r\n\t\tconst { id } = node;\r\n\t\treturn (\r\n\t\t\t<Link className=\"link\" to={`/nodes/${id}`}>\r\n\t\t\t\t<div\r\n\t\t\t\t\tonClick={onClick}\r\n\t\t\t\t\tkey={id}\r\n\t\t\t\t\tclassName=\"pointer hover-bg-near-white bb b--light-gray pa3 pl2\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<NodeName node={node} search={search} />\r\n\t\t\t\t</div>\r\n\t\t\t</Link>\r\n\t\t);\r\n\t}\r\n}\r\n","export const sheetsNodeData = 'https://spreadsheets.google.com/feeds/cells/1FnKRPuEP2e1RIPwGmR1Ne153A_znaU3CzISDG52F-_Y/1/public/full?alt=json';\r\nexport const sheetsLinksData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQZky64G3ynxhwh5QXZ3JLTPFXZ6-XTJmgz96ocdDwsbVIYjIqb0QDL8hxRGyq_Sl22sXbPh1bmFJY9/pubhtml';\r\nexport const sheetsSectorData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRoIfkaY0NUUW6z4nIIVIwufpYMBR2lYzETKSdkLfiuHm34eokO7URgegOoX5tmIKmUvQMXcmH46qSV/pubhtml';\r\nexport const kioskData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQJUXClGCrv8AaD68M1hOgHB3p2si7fmpTM8-dPhbOpvd7l0M0I6zJ47YTdhgY4EoWtQHlIIv9FA2ln/pubhtml';\r\n// https://docs.google.com/spreadsheets/d/e//pubhtml\r\n// https://docs.google.com/spreadsheets/d/1i4P5zhRAfAD6WEy_vBXf5KvZzWpahV4s-fMJ7T7bMQI/edit?usp=sharing\r\nexport const sheetsNodeDataSeattle = 'https://spreadsheets.google.com/feeds/cells/1i4P5zhRAfAD6WEy_vBXf5KvZzWpahV4s-fMJ7T7bMQI/1/public/full?alt=json'\r\nexport const nodeSheetDictionary = {};","import React, { PureComponent } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nimport NodeRow from \"./NodeRow\";\r\n\r\nimport {sheetsNodeData, sheetsLinksData, sheetsSectorData, kioskData} from '../../constants/spreadsheet_endpoints';\r\n\r\nclass SearchBar extends PureComponent {\r\n\tstate = {\r\n\t\tfilteredNodes: [],\r\n\t\tsearch: \"\",\r\n\t\tshowDropdown: false,\r\n\t\tfocused: false\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.keyDownHandler = this.handleKeyDown.bind(this);\r\n\t\twindow.addEventListener(\"keydown\", this.keyDownHandler, false);\r\n\r\n\t\t// const sheetsNodeData = 'https://spreadsheets.google.com/feeds/cells/1FnKRPuEP2e1RIPwGmR1Ne153A_znaU3CzISDG52F-_Y/1/public/full?alt=json';\r\n\t\t// const sheetsLinksData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQZky64G3ynxhwh5QXZ3JLTPFXZ6-XTJmgz96ocdDwsbVIYjIqb0QDL8hxRGyq_Sl22sXbPh1bmFJY9/pubhtml';\r\n\t\t// const sheetsSectorData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRoIfkaY0NUUW6z4nIIVIwufpYMBR2lYzETKSdkLfiuHm34eokO7URgegOoX5tmIKmUvQMXcmH46qSV/pubhtml';\r\n\t\t// const kioskData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQJUXClGCrv8AaD68M1hOgHB3p2si7fmpTM8-dPhbOpvd7l0M0I6zJ47YTdhgY4EoWtQHlIIv9FA2ln/pubhtml';\r\n\t\t\r\n\t\t// check feed, and then entry inside json result. each entry in array should look like below:\r\n\t\t\r\n\t\t//category: [{scheme: \"http://schemas.google.com/spreadsheets/2006\",…}]\r\n\t\t// content: {type: \"text\", $t: \"a\"}\r\n\t\t// gs$cell: {row: \"1\", col: \"1\", inputValue: \"a\", $t: \"a\"}\r\n\t\t// id: {,…}\r\n\t\t// link: [{rel: \"self\", type: \"application/atom+xml\",…}]\r\n\t\t// title: {type: \"text\", $t: \"A1\"}\r\n\t\t// $t: \"A1\"\r\n\t\t// type: \"text\"\r\n\t\t// updated: {$t: \"2021-05-12T22:27:31.991Z\"}\r\n\t\t\r\n\t\t//parsed object should be:\r\n\t\t// {\r\n\t\t//     \"id\": 2,\r\n\t\t//     \"status\": \"Installed\",\r\n\t\t//     \"coordinates\": [\r\n\t\t//       -73.99110519999999,\r\n\t\t//       40.7123462,\r\n\t\t//       74\r\n\t\t//     ],\r\n\t\t//     \"requestDate\": 1426436311615,\r\n\t\t//     \"installDate\": 1513486800000,\r\n\t\t//     \"roofAccess\": false,\r\n\t\t//     \"notes\": \"Peter\",\r\n\t\t//     \"panoramas\": [\r\n\t\t//       \"2.jpg\"\r\n\t\t//     ]\r\n\t\t//   },\r\n\r\n\t\t// TODO:\r\n\t\t// 1. remove weird formatting from some cells after json conversion (???)\r\n\t\t// 2. integrate fetch function into normal application logic\r\n\t\t// 3. test build of functionality in the meshnet website\r\n\t\t// BONUS: draw spreadsheet links from outside static build folder\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\twindow.removeEventListener(\"keydown\", this.keyDownHandler, false);\r\n\t}\r\n\r\n\thandleKeyDown(event) {\r\n\t\tconst { history } = this.props;\r\n\t\tconst { focused, filteredNodes } = this.state;\r\n\t\tconst { keyCode } = event;\r\n\t\tif (keyCode === 13 && focused && filteredNodes.length) {\r\n\t\t\thistory.push(`/nodes/${filteredNodes[0].id}`);\r\n\t\t\tthis.setState({ showDropdown: false });\r\n\t\t\tthis.refs.search.blur();\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t// Super hacky, do this better\r\n\t\tif (\r\n\t\t\tprevState.search === this.state.search &&\r\n\t\t\tprevProps.nodes !== this.props.nodes\r\n\t\t) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tfilteredNodes: this.filterSearch(this.state.search)\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"w-100 shadow-2\">\r\n\t\t\t\t{this.renderSearchBar()}\r\n\t\t\t\t{this.renderList()}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trenderSearchBar() {\r\n\t\tconst { toggleFilters } = this.props;\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"flex items-center bg-white overflow-hidden\"\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tthis.refs.search.focus();\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\twidth=\"20\"\r\n\t\t\t\t\theight=\"20\"\r\n\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\tstroke=\"#aaa\"\r\n\t\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\tclassName=\"ml3 db\"\r\n\t\t\t\t\tstyle={{ minWidth: 20 }}\r\n\t\t\t\t>\r\n\t\t\t\t\t<circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n\t\t\t\t\t<line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\r\n\t\t\t\t</svg>\r\n\t\t\t\t<input\r\n\t\t\t\t\tref=\"search\"\r\n\t\t\t\t\tclassName=\"sans-serif overflow-hidden pl2 pr3 pv3 input-reset f5 fw4 bw0 w-100 on\"\r\n\t\t\t\t\tvalue={this.state.search}\r\n\t\t\t\t\tplaceholder=\"Search nodes\"\r\n\t\t\t\t\tspellCheck={false}\r\n\t\t\t\t\tautoCorrect=\"false\"\r\n\t\t\t\t\tonFocus={() =>\r\n\t\t\t\t\t\tthis.setState({ showDropdown: true, focused: true })\r\n\t\t\t\t\t}\r\n\t\t\t\t\tonBlur={() => this.setState({ focused: false })}\r\n\t\t\t\t\tonChange={event =>\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\tsearch: event.target.value,\r\n\t\t\t\t\t\t\tfilteredNodes: this.filterSearch(event.target.value)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.renderClearButton()}\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName=\"h2 w2 bn bg-transparent mr2 pointer dark-gray\"\r\n\t\t\t\t\tonClick={event => {\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\ttoggleFilters();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\twidth=\"16\"\r\n\t\t\t\t\t\theight=\"16\"\r\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<line x1=\"4\" y1=\"21\" x2=\"4\" y2=\"14\" />\r\n\t\t\t\t\t\t<line x1=\"4\" y1=\"10\" x2=\"4\" y2=\"3\" />\r\n\t\t\t\t\t\t<line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"12\" />\r\n\t\t\t\t\t\t<line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"3\" />\r\n\t\t\t\t\t\t<line x1=\"20\" y1=\"21\" x2=\"20\" y2=\"16\" />\r\n\t\t\t\t\t\t<line x1=\"20\" y1=\"12\" x2=\"20\" y2=\"3\" />\r\n\t\t\t\t\t\t<line x1=\"1\" y1=\"14\" x2=\"7\" y2=\"14\" />\r\n\t\t\t\t\t\t<line x1=\"9\" y1=\"8\" x2=\"15\" y2=\"8\" />\r\n\t\t\t\t\t\t<line x1=\"17\" y1=\"16\" x2=\"23\" y2=\"16\" />\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trenderList() {\r\n\t\tif (!this.state.filteredNodes.length || !this.state.showDropdown) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst { search } = this.state;\r\n\t\treturn (\r\n\t\t\t<div className=\"bg-white bt b--light-gray max-h-5-rows overflow-y-scroll\">\r\n\t\t\t\t{this.state.filteredNodes.map(node => (\r\n\t\t\t\t\t<NodeRow\r\n\t\t\t\t\t\tkey={node.id}\r\n\t\t\t\t\t\tnode={node}\r\n\t\t\t\t\t\tsearch={search}\r\n\t\t\t\t\t\tonClick={() => this.setState({ showDropdown: false })}\r\n\t\t\t\t\t/>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trenderClearButton() {\r\n\t\tconst { search } = this.state;\r\n\r\n\t\tif (!search || !search.length) {\r\n\t\t\treturn (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName=\"mr3\"\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\twidth: 20,\r\n\t\t\t\t\t\theight: 20\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<button\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tsearch: \"\",\r\n\t\t\t\t\t\tfilteredNodes: []\r\n\t\t\t\t\t});\r\n\t\t\t\t}}\r\n\t\t\t\tclassName=\"on btn bn pa0 bg-white pointer mr3 silver\"\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\twidth=\"20\"\r\n\t\t\t\t\theight=\"20\"\r\n\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\tstrokeWidth=\"2\"\r\n\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\tclassName=\"db\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t);\r\n\t}\r\n\r\n\tfilterSearch(search) {\r\n\t\tconst { nodes } = this.props;\r\n\t\tif (!search) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst lowerSearch = search.toLowerCase();\r\n\r\n\t\treturn [\r\n\t\t\t...nodes.filter(\r\n\t\t\t\tnode =>\r\n\t\t\t\t\tnode.id === parseInt(search, 10) ||\r\n\t\t\t\t\tlowerSearch === `node ${node.id}`\r\n\t\t\t),\r\n\t\t\t...nodes\r\n\t\t\t\t.filter(node => {\r\n\t\t\t\t\tconst notesMatch =\r\n\t\t\t\t\t\tnode.notes &&\r\n\t\t\t\t\t\tnode.notes.toLowerCase().indexOf(lowerSearch) > -1;\r\n\t\t\t\t\tconst nameMatches =\r\n\t\t\t\t\t\tnode.name &&\r\n\t\t\t\t\t\tnode.name.toLowerCase().indexOf(lowerSearch) > -1;\r\n\t\t\t\t\treturn notesMatch || nameMatches;\r\n\t\t\t\t})\r\n\t\t\t\t.sort((a, b) => {\r\n\t\t\t\t\tif (a.status !== b.status) {\r\n\t\t\t\t\t\tif (a.status === \"active\") return -1;\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn a.id - b.id;\r\n\t\t\t\t})\r\n\t\t];\r\n\t}\r\n}\r\n\r\nexport default withRouter(SearchBar);\r\n","import { connect } from \"react-redux\";\r\nimport PureSearchBar from \"./component\";\r\nimport { toggleFilters } from \"../../actions\";\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tnodes: state.nodes,\r\n\ttickets: state.tickets\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => ({\r\n\ttoggleFilters: () => toggleFilters(dispatch)\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(PureSearchBar);\r\n","export function fetchNodes(dispatch) {\r\n\tfetch(\"https://node-db.netlify.com/nodes.json\")\r\n\t\t.then(res => res.json())\r\n\t\t.then(json => {\r\n\t\t\tdispatch({ type: \"FETCH_NODES_SUCCESS\", nodes: json });\r\n\t\t})\r\n\t\t.catch(err => console.log(err));\r\n}\r\n\r\nexport function fetchLinks(dispatch) {\r\n\tfetch(\"https://node-db.netlify.com/links.json\")\r\n\t\t.then(res => res.json())\r\n\t\t.then(json => {\r\n\t\t\tdispatch({ type: \"FETCH_LINKS_SUCCESS\", links: json });\r\n\t\t})\r\n\t\t.catch(err => console.log(err));\r\n}\r\n\r\nexport function fetchKiosks(dispatch) {\r\n\tfetch(\"https://node-db.netlify.com/kiosks.json\")\r\n\t\t.then(res => res.json())\r\n\t\t.then(json => {\r\n\t\t\tdispatch({ type: \"FETCH_KIOSKS_SUCCESS\", kiosks: json });\r\n\t\t})\r\n\t\t.catch(err => console.log(err));\r\n}\r\n\r\nexport function toggleFilter(label, dispatch) {\r\n\tdispatch({ type: \"TOGGLE_FILTER\", label });\r\n}\r\n\r\nexport function toggleFilters(dispatch) {\r\n\tdispatch({ type: \"TOGGLE_FILTERS\" });\r\n}\r\n","export function nodeType(node) {\r\n\tconst { status, notes, panoramas } = node;\r\n\tconst lowerNotes = notes ? notes.toLowerCase() : null;\r\n\tconst isSupernode = notes && lowerNotes.indexOf(\"supernode\") > -1;\r\n\tconst isHub = notes && lowerNotes.indexOf(\"hub\") > -1;\r\n\tconst notPotentialHub = !notes || lowerNotes.indexOf(\"hub?\") === -1;\r\n\tconst isOmni = notes && lowerNotes.indexOf(\"omni\") > -1;\r\n\tconst isKiosk = notes && lowerNotes.indexOf(\"kiosk\") > -1;\r\n\tconst isRemote = notes && lowerNotes.indexOf(\"rem\") > -1;\r\n\tconst hasPanoramas = panoramas && panoramas.length;\r\n\r\n\tif (status === \"active\") {\r\n\t\tif (isSupernode) return \"supernode\";\r\n\t\tif (isHub && notPotentialHub) return \"hub\";\r\n\t\tif (isOmni) return \"omni\";\r\n\t\tif (isKiosk) return \"kiosk\";\r\n\t\tif (isRemote) return \"remote\";\r\n\t\treturn \"active\";\r\n\t}\r\n\r\n\tif (isSupernode) return \"potential-supernode\";\r\n\tif (isHub) return \"potential-hub\";\r\n\tif (hasPanoramas) return \"potential\";\r\n\treturn \"dead\";\r\n}\r\n\r\nexport function nodeStatus(node) {\r\n\tconst { status } = node;\r\n\tconst isActive = status === \"Installed\";\r\n\treturn isActive ? \"active\" : \"potential\";\r\n}\r\n\r\n// TODO: Move this to node-db\r\nexport function linkStatus(link) {\r\n\tconst { status, fromNode, toNode } = link;\r\n\tif (!fromNode || !toNode) return \"invalid\";\r\n\tif (\r\n\t\tstatus === \"active\" &&\r\n\t\tfromNode.status === \"active\" &&\r\n\t\ttoNode.status === \"active\"\r\n\t)\r\n\t\treturn \"active\";\r\n\treturn \"potential\";\r\n}\r\n\r\nexport const nodeColors = {\r\n\tactive: \"rgb(255,45,85)\",\r\n\tremote: \"rgb(255,45,85)\",\r\n\tdead: \"#aaa\",\r\n\thub: \"rgb(90,200,250)\",\r\n\tomni: \"rgb(90,200,250)\",\r\n\tlinkNYC: \"#01a2eb\",\r\n\tkiosk: \"rgb(255,45,85)\",\r\n\t\"potential-hub\": \"#777\",\r\n\t\"potential-supernode\": \"#777\",\r\n\tpotential: \"#777\",\r\n\tsupernode: \"#007aff\",\r\n\tsector: \"#007aff\",\r\n\tbackbone: \"#007aff\"\r\n};\r\n\r\nexport const sectorColors = {\r\n\tsupernode: \"#007aff\",\r\n\t\"potential-hub\": \"#aaa\",\r\n\t\"potential-supernode\": \"#aaa\",\r\n\tpotential: \"#aaa\",\r\n\tdefault: \"#007aff\"\r\n};\r\n","import React, { PureComponent } from \"react\";\r\nimport { Polygon } from \"react-google-maps\";\r\nimport { sectorColors } from \"../../utils\";\r\n\r\nconst MAX_OPACITY = 0.2;\r\nconst INTERVAL_PER_MILE = 10;\r\n\r\nconst visibilityMultipliers = {\r\n\thighlight: 1,\r\n\tsecondary: 0,\r\n\tdim: 0\r\n};\r\n\r\nconst zIndexes = {\r\n\thighlight: 3,\r\n\tdim: 1\r\n};\r\n\r\nexport default class Sector extends PureComponent {\r\n\trender() {\r\n\t\tconst { sector, visibility, filters } = this.props;\r\n\t\tconst { status } = sector;\r\n\t\tif (status !== \"active\" && status !== \"potential\") {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif (!filters.sector) return null;\r\n\r\n\t\tconst [lng, lat] = sector.node.coordinates;\r\n\t\tconst { radius, azimuth, width } = sector;\r\n\r\n\t\tconst visibilityMultiplier = visibilityMultipliers[visibility];\r\n\t\tconst multiplier =\r\n\t\t\tvisibilityMultiplier === undefined ? 1 : visibilityMultiplier;\r\n\t\tconst intervalCount = Math.ceil(INTERVAL_PER_MILE * radius);\r\n\t\tconst fillOpacity = (MAX_OPACITY / intervalCount) * multiplier;\r\n\t\tconst fillColor = this.getFillColor();\r\n\t\tconst zIndex = zIndexes[visibility] || 1;\r\n\r\n\t\tconst interval = radius / intervalCount;\r\n\t\tconst radiusIndices = [...Array(intervalCount).keys()];\r\n\r\n\t\treturn radiusIndices.map(index => {\r\n\t\t\tconst circleRadius = interval * index;\r\n\t\t\tconst path = getPath(lat, lng, circleRadius, azimuth, width);\r\n\t\t\treturn (\r\n\t\t\t\t<Polygon\r\n\t\t\t\t\tkey={index}\r\n\t\t\t\t\tpath={path}\r\n\t\t\t\t\toptions={{\r\n\t\t\t\t\t\tstrokeColor: \"transparent\",\r\n\t\t\t\t\t\tstrokeOpacity: 0,\r\n\t\t\t\t\t\tstrokeWidth: 0,\r\n\t\t\t\t\t\tfillColor,\r\n\t\t\t\t\t\tfillOpacity,\r\n\t\t\t\t\t\tclickable: false,\r\n\t\t\t\t\t\tzIndex\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tgetFillColor() {\r\n\t\tconst { sector, node } = this.props;\r\n\t\t// TODO: Make this not hacky\r\n\t\treturn (\r\n\t\t\tsectorColors[sector.status] ||\r\n\t\t\tsectorColors[node.type] ||\r\n\t\t\tsectorColors.default\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction getPath(lat, lng, radius, azimuth, width) {\r\n\tvar centerPoint = { lat, lng };\r\n\tvar PRlat = (radius / 3963) * (180 / Math.PI); // using 3963 miles as earth's radius\r\n\tvar PRlng = PRlat / Math.cos(lat * (Math.PI / 180));\r\n\tvar PGpoints = [];\r\n\tPGpoints.push(centerPoint);\r\n\r\n\tconst lat1 =\r\n\t\tlat + PRlat * Math.cos((Math.PI / 180) * (azimuth - width / 2));\r\n\tconst lon1 =\r\n\t\tlng + PRlng * Math.sin((Math.PI / 180) * (azimuth - width / 2));\r\n\tPGpoints.push({ lat: lat1, lng: lon1 });\r\n\r\n\tconst lat2 =\r\n\t\tlat + PRlat * Math.cos((Math.PI / 180) * (azimuth + width / 2));\r\n\tconst lon2 =\r\n\t\tlng + PRlng * Math.sin((Math.PI / 180) * (azimuth + width / 2));\r\n\r\n\tvar theta = 0;\r\n\tvar gamma = (Math.PI / 180) * (azimuth + width / 2);\r\n\r\n\tfor (var a = 1; theta < gamma; a++) {\r\n\t\ttheta = (Math.PI / 180) * (azimuth - width / 2 + a);\r\n\t\tconst PGlon = lng + PRlng * Math.sin(theta);\r\n\t\tconst PGlat = lat + PRlat * Math.cos(theta);\r\n\r\n\t\tPGpoints.push({ lat: PGlat, lng: PGlon });\r\n\t}\r\n\r\n\tPGpoints.push({ lat: lat2, lng: lon2 });\r\n\tPGpoints.push(centerPoint);\r\n\r\n\treturn PGpoints;\r\n}\r\n","import React, { PureComponent, Fragment } from \"react\";\r\nimport { Marker } from \"react-google-maps\";\r\nimport Sector from \"./Sector\";\r\n\r\nclass NodeMarker extends PureComponent {\r\n\r\n\tcomponentDidMount() {\r\n\t\t//(\"NODEprops: \", this.props);\r\n\t}\r\n\trender() {\r\n\r\n\t\t// images will be in different relation if this is built...\r\n\t\tconst isBuild = true;\r\n\t\tthis.prefix = '';\r\n\t\r\n\t\tif(isBuild) {\r\n\t\t\tthis.prefix = '.';\r\n\t\t}\r\n\r\n\t\tconst { node, visible, onClick } = this.props;\r\n\t\tconst { notes, coordinates, memberNodes } = node;\r\n\t\tconst [lng, lat] = coordinates;\r\n\t\tconst title = `${memberNodes.map(n => n.id).join(\", \")}${\r\n\t\t\tnotes ? ` - ${notes}` : \"\"\r\n\t\t}`;\r\n\t\tconst { icon, zIndex } = this.getMarkerProps();\r\n\t\tconst adjustedZ = this.getZIndex(zIndex);\r\n\t\tconst opacity = this.getOpacity();\r\n\t\tconsole.log(\"ICON: \", icon, opacity, visible, lat, lng);\r\n\t\t//console.log(\"icon!: \", icon);\r\n\t\t//console.log(\"Props and Node: \", this.props, node);\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<Marker\r\n\t\t\t\t\tdefaultPosition={{ lat, lng }}\r\n\t\t\t\t\tdefaultTitle={title}\r\n\t\t\t\t\ticon={icon}\r\n\t\t\t\t\toptions={{ opacity }}\r\n\t\t\t\t\tvisible={visible}\r\n\t\t\t\t\tzIndex={adjustedZ}\r\n\t\t\t\t\tonClick={onClick}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.renderSectors()}\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\trenderSectors() {\r\n\t\tconst { node, visible, visibility, filters } = this.props;\r\n\t\tconst { sectors } = node;\r\n\r\n\t\tif (!sectors || !visible) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn sectors.map(sector => {\r\n\t\t\tconst isFiltered =\r\n\t\t\t\tsector.status === \"potential\" &&\r\n\t\t\t\tfilters[sector.status] === false;\r\n\t\t\tif (isFiltered && visibility !== \"highlight\") {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tconst key = `${node.id}-${sector.azimuth}-${sector.width}`\r\n\t\t\treturn (\r\n\t\t\t\t<Sector\r\n\t\t\t\t\tkey={key}\r\n\t\t\t\t\tsector={sector}\r\n\t\t\t\t\tvisibility={visibility}\r\n\t\t\t\t\tnode={node}\r\n\t\t\t\t\tfilters={filters}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tgetOpacity() {\r\n\t\tconst { visibility } = this.props;\r\n\t\tif (visibility === \"highlight\") return 1;\r\n\t\tif (visibility === \"secondary\") return 1;\r\n\t\tif (visibility === \"dim\") return 0.25;\r\n\t\treturn 1;\r\n\t}\r\n\r\n\tgetZIndex(defaultZIndex) {\r\n\t\tconst { visibility } = this.props;\r\n\t\tif (visibility === \"highlight\") return defaultZIndex + 999;\r\n\t\tif (visibility === \"secondary\") return defaultZIndex + 998;\r\n\t\treturn defaultZIndex;\r\n\t}\r\n\r\n\tgetMarkerProps() {\r\n\t\tconst { node, filters } = this.props;\r\n\t\tconst { type } = node;\r\n\t//\tconsole.log(\"noe detttpye: \", type);\r\n\r\n\t\tif (type === \"supernode\")\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl: this.prefix + \"/img/map/supernode.svg\",\r\n\t\t\t\t\tanchor: { x: 14, y: 14 }\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 100\r\n\t\t\t};\r\n\r\n\t\tif (type === \"hub\")\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl: this.prefix + \"/img/map/hub.svg\",\r\n\t\t\t\t\tanchor: { x: 10, y: 10 }\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 93\r\n\t\t\t};\r\n\r\n\t\tif (type === \"omni\") {\r\n\t\t\tconst url = filters.backbone\r\n\t\t\t\t? this.prefix + \"/img/map/omni.svg\"\r\n\t\t\t\t: this.prefix + \"/img/map/active.svg\";\r\n\t\t\tconst zIndex = filters.backbone ? 92 : 91;\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl,\r\n\t\t\t\t\tanchor: { x: 7, y: 7 }\r\n\t\t\t\t},\r\n\t\t\t\tzIndex\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (type === \"remote\") {\r\n\t\t\tconst url = filters.backbone\r\n\t\t\t\t? this.prefix + \"/img/map/remote.svg\"\r\n\t\t\t\t: this.prefix + \"/img/map/active.svg\";\r\n\t\t\tconst anchor = filters.backbone ? { x: 5, y: 5 } : { x: 7, y: 7 };\r\n\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl,\r\n\t\t\t\t\tanchor\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 90\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (type === \"kiosk\") {\r\n\t\t\tconst url = filters.backbone\r\n\t\t\t\t? this.prefix + \"/img/map/remote.svg\"\r\n\t\t\t\t: this.prefix + \"/img/map/active.svg\";\r\n\t\t\tconst anchor = filters.backbone ? { x: 5, y: 5 } : { x: 7, y: 7 };\r\n\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl,\r\n\t\t\t\t\tanchor\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 90\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (type === \"active\")\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl: this.prefix + \"/img/map/active.svg\",\r\n\t\t\t\t\tanchor: { x: 7, y: 7 }\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 91\r\n\t\t\t};\r\n\r\n\t\tif (type === \"potential-supernode\")\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl: this.prefix + \"/img/map/potential-supernode.svg\",\r\n\t\t\t\t\tanchor: { x: 14, y: 14 }\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 83\r\n\t\t\t};\r\n\r\n\t\tif (type === \"potential-hub\")\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl: this.prefix + \"/img/map/potential-hub.svg\",\r\n\t\t\t\t\tanchor: { x: 10, y: 10 }\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 82\r\n\t\t\t};\r\n\r\n\t\tif (type === \"potential\")\r\n\t\t\treturn {\r\n\t\t\t\ticon: {\r\n\t\t\t\t\turl: this.prefix + \"/img/map/potential.svg\",\r\n\t\t\t\t\tanchor: { x: 7, y: 7 }\r\n\t\t\t\t},\r\n\t\t\t\tzIndex: 81\r\n\t\t\t};\r\n\r\n\t\treturn {\r\n\t\t\ticon: {\r\n\t\t\t\turl: this.prefix + \"/img/map/dead.svg\",\r\n\t\t\t\tanchor: { x: 5, y: 5 }\r\n\t\t\t},\r\n\t\t\tzIndex: 80\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport default class VisibilityMarker extends PureComponent {\r\n\tstate = {\r\n\t\tvisibility: \"default\"\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<NodeMarker {...this.props} visibility={this.state.visibility} />\r\n\t\t);\r\n\t}\r\n\r\n\tsetVisibility(visibility) {\r\n\t\tthis.setState({ visibility });\r\n\t}\r\n}\r\n","import React, { PureComponent } from \"react\";\r\nimport { Marker } from \"react-google-maps\";\r\n\r\nexport default class KioskMarker extends PureComponent {\r\n\trender() {\r\n\t\tconst { kiosk } = this.props;\r\n\t\tconst [lng, lat] = kiosk.coordinates;\r\n\t\tconst icon = {\r\n\t\t\turl: \"/img/map/kiosk.svg\",\r\n\t\t\tanchor: { x: 5, y: 5 }\r\n\t\t};\r\n\t\treturn <Marker defaultPosition={{ lat, lng }} icon={icon} zIndex={1} />;\r\n\t}\r\n}\r\n","import React, { PureComponent } from \"react\";\r\nimport { Polyline } from \"react-google-maps\";\r\n\r\nexport default class LinkLine extends PureComponent {\r\n\tstate = {\r\n\t\tvisibility: \"default\"\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { link, visible } = this.props;\r\n\t\tconst { fromNode, toNode } = link;\r\n\r\n\t\tif (!fromNode || !toNode) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst [lng1, lat1] = fromNode.coordinates;\r\n\t\tconst [lng2, lat2] = toNode.coordinates;\r\n\t\tconst latlng1 = { lat: lat1, lng: lng1 };\r\n\t\tconst latlng2 = { lat: lat2, lng: lng2 };\r\n\r\n\t\tconst { strokeColor, strokeOpacity, zIndex } = this.getLineProps();\r\n\r\n\t\treturn (\r\n\t\t\t<Polyline\r\n\t\t\t\tpath={[latlng1, latlng2]}\r\n\t\t\t\toptions={{\r\n\t\t\t\t\tstrokeColor,\r\n\t\t\t\t\tstrokeWeight: 2.5,\r\n\t\t\t\t\tstrokeOpacity: this.getOpacity(strokeOpacity),\r\n\t\t\t\t\tzIndex: this.getZIndex(zIndex)\r\n\t\t\t\t}}\r\n\t\t\t\tvisible={visible}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tgetOpacity(defaultOpacity) {\r\n\t\tconst { link, filters } = this.props;\r\n\t\tconst { visibility } = this.state;\r\n\t\tswitch (visibility) {\r\n\t\t\tcase \"highlight\":\r\n\t\t\t\tif (filters.backbone) {\r\n\t\t\t\t\tif (!isBackbone(link)) return defaultOpacity * 2;\r\n\t\t\t\t}\r\n\t\t\t\treturn 1;\r\n\t\t\tcase \"dim\":\r\n\t\t\t\treturn defaultOpacity * 0.1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn defaultOpacity;\r\n\t\t}\r\n\t}\r\n\r\n\tgetZIndex(defaultZIndex) {\r\n\t\tconst { link } = this.props;\r\n\t\tconst { visibility } = this.state;\r\n\t\tconst bonus = link.status === \"active\" ? 20 : 0;\r\n\t\tif (visibility === \"highlight\") return 30 + bonus;\r\n\t\treturn defaultZIndex + bonus;\r\n\t}\r\n\r\n\tsetVisibility(visibility) {\r\n\t\tthis.setState({ visibility });\r\n\t}\r\n\r\n\tgetLineProps() {\r\n\t\tconst { link, filters } = this.props;\r\n\t\tconst { status } = link;\r\n\r\n\t\tconst defaultOpacity = 1;\r\n\r\n\t\tif (status === \"active\") {\r\n\t\t\tif (filters.backbone && !isBackbone(link))\r\n\t\t\t\treturn {\r\n\t\t\t\t\tstrokeColor: \"#ff2d55\",\r\n\t\t\t\t\tstrokeOpacity: defaultOpacity * 0.25,\r\n\t\t\t\t\tzIndex: 10\r\n\t\t\t\t};\r\n\r\n\t\t\treturn {\r\n\t\t\t\tstrokeColor: \"#007aff\",\r\n\t\t\t\tstrokeOpacity: defaultOpacity,\r\n\t\t\t\tzIndex: 20\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tstrokeColor: \"#aaa\",\r\n\t\t\tstrokeOpacity: defaultOpacity,\r\n\t\t\tzIndex: 0\r\n\t\t};\r\n\t}\r\n}\r\n\r\nfunction isBackbone(link) {\r\n\tconst { fromNode, toNode } = link;\r\n\treturn fromNode.type !== \"active\" && toNode.type !== \"active\";\r\n}\r\n","import React, { PureComponent } from \"react\";\r\nimport { OverlayView } from \"react-google-maps\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst getPixelPositionOffset = (width, height) => ({\r\n\tx: -width / 2,\r\n\ty: -height\r\n});\r\n\r\nexport default class NodeDetail extends PureComponent {\r\n\trender() {\r\n\t\tconst { nodeId, nodesById } = this.props;\r\n\r\n\t\tif (!nodeId || !nodesById) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst node = nodesById[nodeId];\r\n\t\tif (!node) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst { coordinates } = node;\r\n\t\tconst [lng, lat] = coordinates;\r\n\r\n\t\treturn (\r\n\t\t\t<OverlayView\r\n\t\t\t\tposition={new window.google.maps.LatLng(lat, lng)}\r\n\t\t\t\tmapPaneName={OverlayView.OVERLAY_MOUSE_TARGET}\r\n\t\t\t\tgetPixelPositionOffset={getPixelPositionOffset}\r\n\t\t\t>\r\n\t\t\t\t<div\r\n\t\t\t\t\tref={ref =>\r\n\t\t\t\t\t\tref &&\r\n\t\t\t\t\t\twindow.google.maps.OverlayView.preventMapHitsFrom(ref)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclassName=\"flex flex-column items-center\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className=\"flex items-center bg-white br2 overflow-hidden shadow-2\">\r\n\t\t\t\t\t\t{this.renderImage(node)}\r\n\t\t\t\t\t\t<div className=\"pv1 ph2 flex flex-column justify-end\">\r\n\t\t\t\t\t\t\t<span className=\"f5 fw6 nowrap sans-serif\">\r\n\t\t\t\t\t\t\t\t{node.name || node.id}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\tviewBox=\"0 5 12 12\"\r\n\t\t\t\t\t\tversion=\"1.1\"\r\n\t\t\t\t\t\twidth=\"12\"\r\n\t\t\t\t\t\theight=\"12\"\r\n\t\t\t\t\t\taria-hidden=\"true\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\tfillRule=\"evenodd\"\r\n\t\t\t\t\t\t\tfill=\"white\"\r\n\t\t\t\t\t\t\td=\"M0 5l6 6 6-6H0z\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</div>\r\n\t\t\t</OverlayView>\r\n\t\t);\r\n\t}\r\n\r\n\trenderImage(node) {\r\n\t\tconst { id, panoramas } = node;\r\n\t\tif (!panoramas || !panoramas.length) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst [firstPanorama] = panoramas;\r\n\t\treturn (\r\n\t\t\t<Link to={`/nodes/${id}/panoramas/1`} className=\"db h2 w2\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName=\"h-100 w-100 cover bg-center bg-near-white\"\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tbackgroundImage: `url(\"https://node-db.netlify.com/panoramas/${firstPanorama}\")`\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</Link>\r\n\t\t);\r\n\t}\r\n\r\n\trenderNotes(node) {\r\n\t\tconst { notes } = node;\r\n\t\tif (!notes) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn <span className=\"mv0 f7 gray truncate sans-serif\">{notes}</span>;\r\n\t}\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport PureComponent from \"./component\";\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tnodesById: state.nodesById\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(PureComponent);\r\n","import React, { PureComponent } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport DocumentTitle from \"react-document-title\";\r\n\r\nexport default class Gallery extends PureComponent {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tpanoramas: this.getPanoramas()\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.keyDownHandler = this.handleKeyDown.bind(this);\r\n\t\twindow.addEventListener(\"keydown\", this.keyDownHandler, true);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\twindow.removeEventListener(\"keydown\", this.keyDownHandler, true);\r\n\t}\r\n\r\n\thandleKeyDown(event) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\t\tconst { keyCode } = event;\r\n\t\tconst { match, history } = this.props;\r\n\t\tconst { panoramas } = this.state;\r\n\t\tconst { nodeId, panoId } = match.params;\r\n\t\tconst panoIdInt = parseInt(panoId);\r\n\t\tif (keyCode === 27) {\r\n\t\t\thistory.push(`/nodes/${nodeId}`);\r\n\t\t} else if (keyCode === 39) {\r\n\t\t\tconst nextPanoId = panoIdInt < panoramas.length ? panoIdInt + 1 : 1;\r\n\t\t\thistory.push(`/nodes/${nodeId}/panoramas/${nextPanoId}`);\r\n\t\t} else if (keyCode === 37) {\r\n\t\t\tconst prevPanoId = panoId > 1 ? panoIdInt - 1 : panoramas.length;\r\n\t\t\thistory.push(`/nodes/${nodeId}/panoramas/${prevPanoId}`);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { match } = this.props;\r\n\t\tconst { nodeId, panoId } = match.params;\r\n\t\tconst { panoramas } = this.state;\r\n\t\tconst src = panoramas[panoId - 1];\r\n\r\n\t\treturn (\r\n\t\t\t<DocumentTitle\r\n\t\t\t\ttitle={`Panorama ${panoId} - Node ${nodeId} - NYC Mesh`}\r\n\t\t\t>\r\n\t\t\t\t<div className=\"fixed absolute--fill bg-black flex flex-column items-center justify-center z-max\">\r\n\t\t\t\t\t<Link to=\"..\" className=\"absolute top-0 left-0 ma3 white\">\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\tclassName=\"db ma0\"\r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\twidth=\"24\"\r\n\t\t\t\t\t\t\theight=\"24\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\tstrokeWidth=\"3\"\r\n\t\t\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n\t\t\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t<img\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\twindow\r\n\t\t\t\t\t\t\t\t.open(\r\n\t\t\t\t\t\t\t\t\t`https://node-db.netlify.com/panoramas/${src}`,\r\n\t\t\t\t\t\t\t\t\t\"_blank\"\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t.focus()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tclassName=\"db center mh-100 mw-100 zoom-in\"\r\n\t\t\t\t\t\tsrc={`https://node-db.netlify.com/panoramas/${src}`}\r\n\t\t\t\t\t\talt=\"Panorama\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{this.renderPreviews()}\r\n\t\t\t\t</div>\r\n\t\t\t</DocumentTitle>\r\n\t\t);\r\n\t}\r\n\r\n\trenderPreviews() {\r\n\t\tconst { match } = this.props;\r\n\t\tconst { nodeId, panoId } = match.params;\r\n\t\tconst { panoramas } = this.state;\r\n\t\tif (!panoramas || !panoramas.length) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div className=\"absolute bottom-0 right-0 left-0 flex ph1 pv2 overflow-x-scroll\">\r\n\t\t\t\t{panoramas.map((panorama, index) => (\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\tto={`/nodes/${nodeId}/panoramas/${index + 1}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={`node-image mh1 cover ba bw1 b--white ${\r\n\t\t\t\t\t\t\t\tindex === panoId - 1 ? \"\" : \"o-30\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tbackgroundImage: `url(\"https://node-db.netlify.com/panoramas/${panorama}\")`\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tgetPanoramas() {\r\n\t\tconst { match, nodesById } = this.props;\r\n\t\tconst { nodeId } = match.params;\r\n\t\tconst node = nodesById[nodeId];\r\n\r\n\t\tif (!node) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst { panoramas } = node;\r\n\t\tif (!panoramas || !panoramas.length) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\treturn panoramas;\r\n\t}\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport PureGallery from \"./component\";\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tnodesById: state.nodesById\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(PureGallery);\r\n","import React, { Component, Fragment } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { withScriptjs, withGoogleMap, GoogleMap } from \"react-google-maps\";\r\nimport { withRouter, Route } from \"react-router\";\r\nimport DocumentTitle from \"react-document-title\";\r\nimport { uniq, isEqual } from \"lodash\";\r\n\r\nimport NodeMarker from \"./NodeMarker\";\r\nimport KioskMarker from \"./KioskMarker\";\r\nimport LinkLine from \"./LinkLine\";\r\nimport NodeDetail from \"../NodeDetail\";\r\nimport Gallery from \"../Gallery\";\r\n\r\nimport { mapStyles } from \"./styles\";\r\n\r\nconst DEFAULT_ZOOM = 11;\r\n//nYC center lat lng\r\n// const DEFAULT_CENTER = { lat: 40.72, lng: -73.9595798 };\r\n// for seattle this is lat lng\r\n// 47.6062° N, 122.3321° W\r\nconst DEFAULT_CENTER = { lat: 47.6062, lng: -122.3321 };\r\n\r\n\r\nconst options = {\r\n\tstyles: mapStyles,\r\n\tfullscreenControl: false,\r\n\tstreetViewControl: false,\r\n\tzoomControlOptions: {\r\n\t\tposition: 9\r\n\t},\r\n\tmapTypeControlOptions: {\r\n\t\tposition: 3\r\n\t},\r\n\tbackgroundColor: \"#f5f5f5\",\r\n\tgestureHandling: \"greedy\",\r\n\tclickableIcons: false\r\n};\r\n\r\nconst MapComponent = withScriptjs(\r\n\twithGoogleMap(props => (\r\n\t\t<GoogleMap ref={props.mapRef} {...props}>\r\n\t\t\t{props.children}\r\n\t\t</GoogleMap>\r\n\t))\r\n);\r\n\r\nclass MapView extends Component {\r\n\tstate = {\r\n\t\tcommandPressed: false\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.map = React.createRef();\r\n\t\tthis.markerRefs = {};\r\n\t\tthis.lineRefs = {};\r\n\t\tthis.lastDoubleClick = Date.now();\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\r\n\t\tthis.keyDownHandler = this.handleKeyDown.bind(this);\r\n\t\tthis.keyUpHandler = this.handleKeyUp.bind(this);\r\n\t\twindow.addEventListener(\"keydown\", this.keyDownHandler, false);\r\n\t\twindow.addEventListener(\"keyup\", this.keyUpHandler, false);\r\n\r\n\t\tif (this.props.match) {\r\n\t\t\ttry {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.handleSelectedChange(this.props);\r\n\t\t\t\t}, 500);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\twindow.removeEventListener(\"keydown\", this.keyDownHandler, false);\r\n\t\twindow.removeEventListener(\"keyup\", this.keyUpHandler, false);\r\n\t}\r\n\r\n\t// This is a kinda hacky way to improve performance\r\n\t// Instead of rerending the entire map, rerender specific nodes\r\n\tshouldComponentUpdate(nextProps) {\r\n\t\tconst nodesChanged = !isEqual(this.props.nodes, nextProps.nodes);\r\n\t\tconst matchChanged = this.props.match !== nextProps.match;\r\n\t\tconst filtersChanged = this.props.filters !== nextProps.filters;\r\n\t\tif (nodesChanged || matchChanged || filtersChanged) {\r\n\t\t\tthis.handleSelectedChange(nextProps);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\thandleKeyDown(event) {\r\n\t\tconst { keyCode } = event;\r\n\t\tif (keyCode === 27) {\r\n\t\t\tconst { history } = this.props;\r\n\t\t\thistory.push(\"/\");\r\n\t\t}\r\n\r\n\t\t// Command key\r\n\t\tif (keyCode === 91 || keyCode === 93) {\r\n\t\t\tthis.setState({ commandPressed: true });\r\n\t\t}\r\n\t}\r\n\r\n\thandleKeyUp(event) {\r\n\t\tconst { keyCode } = event;\r\n\r\n\t\t// Command key\r\n\t\tif (keyCode === 91 || keyCode === 93) {\r\n\t\t\tthis.setState({ commandPressed: false });\r\n\t\t}\r\n\t}\r\n\r\n\thandleSelectedChange(nextProps) {\r\n\t\t// If selected node is unchanged, do not rerender\r\n\t\tif (!this.props.match && !nextProps.match) return false;\r\n\r\n\t\t// If one was selected but none now selected, reset all nodes\r\n\t\tif (!nextProps.match) {\r\n\t\t\tthis.resetAllNodes();\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst nextSelectedNodeIds = this.selectedNodeIds(nextProps.match);\r\n\t\tconst nextSelectedMarkers = nextSelectedNodeIds\r\n\t\t\t.map(id => this.markerRefs[id])\r\n\t\t\t.filter(m => m); // filter null\r\n\r\n\t\tif (!nextSelectedMarkers.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst nextSelectedNodes = nextSelectedMarkers.map(\r\n\t\t\tmarker => marker.props.node\r\n\t\t);\r\n\t\tthis.updateNodes(nextSelectedNodes, nextSelectedMarkers);\r\n\r\n\t\t// const matchChanged = this.props.match !== nextProps.match;\r\n\t\t// const nodesChanged = this.props.nodes !== nextProps.nodes;\r\n\t\t// const fitBounds = !matchChanged && !nodesChanged;\r\n\r\n\t\tconst filtersChanged = this.props.filters !== nextProps.filters;\r\n\r\n\t\tif (!filtersChanged) {\r\n\t\t\tthis.updateLinks(nextSelectedNodes);\r\n\t\t\tthis.panToNodes(nextSelectedNodes, true);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { history } = this.props;\r\n\t\treturn (\r\n\t\t\t<MapComponent\r\n\t\t\t\tmapRef={this.map}\r\n\t\t\t\tdefaultZoom={DEFAULT_ZOOM}\r\n\t\t\t\tdefaultCenter={DEFAULT_CENTER}\r\n\t\t\t\tdefaultOptions={options}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\t// TODO: Make this less hacky\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tconst now = Date.now();\r\n\t\t\t\t\t\tif (now - this.lastDoubleClick > 2000) {\r\n\t\t\t\t\t\t\thistory.push(\"/\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t}}\r\n\t\t\t\tonDblClick={() => {\r\n\t\t\t\t\tconst now = Date.now();\r\n\t\t\t\t\tthis.lastDoubleClick = now;\r\n\t\t\t\t}}\r\n\t\t\t\tloadingElement={<div className=\"h-100 flex flex-column\" />}\r\n\t\t\t\tcontainerElement={<div className=\"h-100 flex flex-column\" />}\r\n\t\t\t\tmapElement={<div className=\"h-100 flex flex-column\" />}\r\n\t\t\t\tgoogleMapURL=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBNClp7oJsw-eleEoR3-PQKV23tpeW-FpE\"\r\n\t\t\t>\r\n\t\t\t\t{this.renderLinks()}\r\n\t\t\t\t{this.renderKiosks()}\r\n\t\t\t\t{this.renderNodes()}\r\n\t\t\t{this.renderNodeDetail()}\r\n\t\t\t\t<Route\r\n\t\t\t\t\texact\r\n\t\t\t\t\tpath=\"/nodes/:nodeId/panoramas/:panoId\"\r\n\t\t\t\t\tcomponent={Gallery}\r\n\t\t\t\t/>\r\n\t\t\t</MapComponent>\r\n\t\t);\r\n\t}\r\n\r\n\trenderNodes() {\r\n\t\tconst { nodes, filters } = this.props;\r\n\t\tlet _nodes = Object.assign({}, nodes);\r\n\t\tconsole.log(\"_nodes: \", _nodes);\r\n\t\t// TODO: Refactor\r\n\t\tconst selectedIds = this.selectedNodeIds().reduce(\r\n\t\t\t(idMap, nodeId) => ({ ...idMap, [nodeId]: true }),\r\n\t\t\t{}\r\n\t\t);\r\n\t\treturn nodes.map(node => {\r\n\t\t\tconst isFiltered = filters[node.type] === false;\r\n\t\t\tconst isSelected = selectedIds[node.id] === true;\r\n\t\t\tlet neighborIsSelected = false;\r\n\t\t\tif (node.links) {\r\n\t\t\t\tnode.links.forEach(link => {\r\n\t\t\t\t\tif (selectedIds[link.from] && selectedIds[link.to]) {\r\n\t\t\t\t\t\tneighborIsSelected = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t//\tconst visible = true;\r\n\t\t\tconst visible = !isFiltered || isSelected || neighborIsSelected;\r\n\t\t\treturn (\r\n\t\t\t\t<NodeMarker\r\n\t\t\t\t\tkey={node.id}\r\n\t\t\t\t\tnode={node}\r\n\t\t\t\t\tvisible={visible}\r\n\t\t\t\t\tfilters={filters}\r\n\t\t\t\t\tonClick={() => this.handleNodeClick(node)}\r\n\t\t\t\t\tref={ref => this.handleMarkerRef(ref)}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\trenderLinks() {\r\n\t\tconst { links, filters } = this.props;\r\n\r\n\t\t// TODO: Refactor\r\n\t\tconst selectedIds = this.selectedNodeIds().reduce(\r\n\t\t\t(idMap, nodeId) => ({ ...idMap, [nodeId]: true }),\r\n\t\t\t{}\r\n\t\t);\r\n\r\n\t\treturn links.map((link, index) => {\r\n\t\t\tconst { fromNode, toNode, status } = link;\r\n\t\t\tif (!fromNode || !toNode) return null;\r\n\r\n\t\t\tconst isSelected =\r\n\t\t\t\tselectedIds[fromNode.id] && selectedIds[toNode.id];\r\n\t\t\tconst isFiltered =\r\n\t\t\t\tfilters[fromNode.type] === false ||\r\n\t\t\t\tfilters[toNode.type] === false ||\r\n\t\t\t\t(status === \"potential\" && filters.potential === false);\r\n\t\t\tconst visible = isSelected || !isFiltered;\r\n\t\t\treturn (\r\n\t\t\t\t<LinkLine\r\n\t\t\t\t\tkey={this.linkId(link)}\r\n\t\t\t\t\tref={ref => {\r\n\t\t\t\t\t\tthis.handleLineRef(ref);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvisible={visible}\r\n\t\t\t\t\tlink={link}\r\n\t\t\t\t\tfilters={filters}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\trenderKiosks() {\r\n\t\tconst { kiosks } = this.props;\r\n\t\treturn kiosks.map(kiosk => (\r\n\t\t\t<KioskMarker key={kiosk.id} kiosk={kiosk} />\r\n\t\t));\r\n\t}\r\n\r\n\trenderNodeDetail() {\r\n\t\tconst { match } = this.props;\r\n\t\tif (!match || !match.params) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst nodeIds = this.selectedNodeIds();\r\n\r\n\t\tconst nodeTitles = nodeIds.join(\", \");\r\n\t\tconst title = `${nodeTitles} - Map - NYC Mesh`;\r\n\t\treturn (\r\n\t\t\t<DocumentTitle title={title}>\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t{nodeIds.map(id => (\r\n\t\t\t\t\t\t<NodeDetail key={id} nodeId={id} />\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Fragment>\r\n\t\t\t</DocumentTitle>\r\n\t\t);\r\n\t}\r\n\r\n\thandleNodeClick(node) {\r\n\t\tconst { match, history } = this.props;\r\n\r\n\t\t// Command click selects multiple nodes\r\n\t\tif (this.state.commandPressed && match && match.params.nodeId) {\r\n\t\t\tconst nodeIds = this.selectedNodeIds();\r\n\t\t\tconst selectedId = node.id.toString();\r\n\r\n\t\t\tlet newNodeIds = [];\r\n\t\t\tif (nodeIds.indexOf(selectedId) > -1) {\r\n\t\t\t\tnewNodeIds = nodeIds.filter(nodeId => nodeId !== selectedId);\r\n\t\t\t} else {\r\n\t\t\t\tnodeIds.push(selectedId);\r\n\t\t\t\tnewNodeIds = nodeIds;\r\n\t\t\t}\r\n\r\n\t\t\tconst newNodeIdString = uniq(newNodeIds)\r\n\t\t\t\t.sort()\r\n\t\t\t\t.join(\"-\");\r\n\t\t\thistory.replace(`/nodes/${newNodeIdString}`);\r\n\t\t} else {\r\n\t\t\thistory.push(`/nodes/${node.id}`);\r\n\t\t}\r\n\t}\r\n\r\n\tresetAllNodes() {\r\n\t\tReactDOM.unstable_batchedUpdates(() => {\r\n\t\t\tObject.values(this.markerRefs).forEach(marker =>\r\n\t\t\t\tmarker.setVisibility(\"default\")\r\n\t\t\t);\r\n\r\n\t\t\tObject.values(this.lineRefs).forEach(line =>\r\n\t\t\t\tline.setVisibility(\"default\")\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tupdateNodes(selectedNodes, markers) {\r\n\t\tReactDOM.unstable_batchedUpdates(() => {\r\n\t\t\t// Dim all nodes\r\n\t\t\tObject.values(this.markerRefs).forEach(marker => {\r\n\t\t\t\tmarker.setVisibility(\"dim\");\r\n\t\t\t});\r\n\r\n\t\t\t// Highlight directly connected nodes\r\n\t\t\tselectedNodes.forEach(node => {\r\n\t\t\t\tif (node.connectedNodes) {\r\n\t\t\t\t\tnode.connectedNodes.forEach(nodeId => {\r\n\t\t\t\t\t\tconst connectedMarker = this.markerRefs[nodeId];\r\n\t\t\t\t\t\tif (connectedMarker) {\r\n\t\t\t\t\t\t\tconnectedMarker.setVisibility(\"secondary\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Highlight selected nodes\r\n\t\t\tmarkers.forEach(marker => marker.setVisibility(\"highlight\"));\r\n\t\t});\r\n\t}\r\n\r\n\tupdateLinks(nodes) {\r\n\t\tReactDOM.unstable_batchedUpdates(() => {\r\n\t\t\t// Dim all links\r\n\t\t\tObject.values(this.lineRefs).forEach(line =>\r\n\t\t\t\tline.setVisibility(\"dim\")\r\n\t\t\t);\r\n\r\n\t\t\t// Highlight direct links\r\n\t\t\tnodes.forEach(node => {\r\n\t\t\t\tif (node.links) {\r\n\t\t\t\t\tnode.links.forEach(link => {\r\n\t\t\t\t\t\tconst line = this.lineRefs[this.linkId(link)];\r\n\t\t\t\t\t\tif (line) {\r\n\t\t\t\t\t\t\tline.setVisibility(\"highlight\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpanToNodes(nodes, fitBounds) {\r\n\t\tif (nodes.length === 1) {\r\n\t\t\tconst [lng, lat] = nodes[0].coordinates;\r\n\t\t\tthis.map.current.panTo({ lng, lat });\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet minLng = 9999,\r\n\t\t\tminLat = 9999,\r\n\t\t\tmaxLng = -9999,\r\n\t\t\tmaxLat = -9999;\r\n\r\n\t\tnodes.forEach(node => {\r\n\t\t\tconst [lng, lat] = node.coordinates;\r\n\t\t\tif (lng < minLng) minLng = lng;\r\n\t\t\tif (lng > maxLng) maxLng = lng;\r\n\t\t\tif (lat < minLat) minLat = lat;\r\n\t\t\tif (lat > maxLat) maxLat = lat;\r\n\t\t});\r\n\r\n\t\tconst newBounds = {\r\n\t\t\teast: maxLng,\r\n\t\t\tnorth: maxLat,\r\n\t\t\tsouth: minLat,\r\n\t\t\twest: minLng\r\n\t\t};\r\n\r\n\t\tif (fitBounds) {\r\n\t\t\tthis.map.current.fitBounds(newBounds, window.innerWidth / 10);\r\n\t\t} else {\r\n\t\t\tthis.map.current.panToBounds(newBounds, window.innerWidth / 10);\r\n\t\t}\r\n\t}\r\n\r\n\thandleMarkerRef(ref) {\r\n\t\tif (ref) {\r\n\t\t\tthis.markerRefs[ref.props.node.id] = ref;\r\n\t\t}\r\n\t}\r\n\r\n\thandleLineRef(ref) {\r\n\t\tif (ref) {\r\n\t\t\tthis.lineRefs[this.linkId(ref.props.link)] = ref;\r\n\t\t}\r\n\t}\r\n\r\n\tlinkId(link) {\r\n\t\treturn `${link.from}-${link.to} ${link.status}`;\r\n\t}\r\n\r\n\tselectedNodeIds(match = this.props.match) {\r\n\t\tif (!match || !match.params || !match.params.nodeId) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\treturn match.params.nodeId.split(\"-\");\r\n\t}\r\n}\r\n\r\nexport default withRouter(MapView);\r\n","export const mapStyles = [\r\n\t{\r\n\t\telementType: \"labels.icon\",\r\n\t\tstylers: [\r\n\t\t\t{\r\n\t\t\t\tvisibility: \"off\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\tfeatureType: \"road\",\r\n\t\telementType: \"labels.icon\",\r\n\t\tstylers: [\r\n\t\t\t{\r\n\t\t\t\tvisibility: \"off\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\tfeatureType: \"road.highway\",\r\n\t\tstylers: [\r\n\t\t\t{\r\n\t\t\t\tvisibility: \"off\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\tfeatureType: \"transit\",\r\n\t\tstylers: [\r\n\t\t\t{\r\n\t\t\t\tvisibility: \"off\"\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n];\r\n","import { connect } from \"react-redux\";\r\nimport PureMapView from \"./component\";\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tnodes: state.nodes,\r\n\tlinks: state.links,\r\n\tsectors: state.sectors,\r\n\tkiosks: state.kiosks,\r\n\tfilters: state.filters\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(PureMapView);\r\n","import React, { PureComponent } from \"react\";\r\n\r\nimport { icons } from \"../NodeName\";\r\nimport { nodeColors } from \"../../utils\";\r\n\r\n// This should be defined elsewhere\r\nconst labels = [\r\n\t\"active\",\r\n\t\"remote\",\r\n\t\"kiosk\",\r\n\t\"omni\",\r\n\t\"hub\",\r\n\t\"supernode\",\r\n\t\"potential\",\r\n\t\"potential-hub\",\r\n\t\"potential-supernode\",\r\n\t\"linkNYC\",\r\n\t\"sector\"\r\n];\r\n\r\nexport default class Filters extends PureComponent {\r\n\tcomponentDidMount() {\r\n\t\tconst { toggleFilter } = this.props;\r\n\t\tconst params = new URLSearchParams(this.props.location.search);\r\n\t\tif (params.get(\"potential\") === \"true\") toggleFilter(\"potential\");\r\n\t\tif (params.get(\"linknyc\") === \"true\") toggleFilter(\"linkNYC\");\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { showFilters } = this.props;\r\n\t\tif (!showFilters) return null;\r\n\t\treturn (\r\n\t\t\t<div className=\"bg-white f5 shadow-2\">\r\n\t\t\t\t<div role=\"group\" className=\"dib pa2\">\r\n\t\t\t\t\t<div className=\"flex flex-column-ns flex-wrap justify-between\">\r\n\t\t\t\t\t\t{labels.map(label => this.renderFilter(label))}\r\n\t\t\t\t\t\t{this.renderFilter(\"backbone\", true)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trenderFilter(label, hideCount) {\r\n\t\tconst { filters, statusCounts, toggleFilter } = this.props;\r\n\t\tconst enabled = filters[label] || filters[label] === undefined;\r\n\t\tconst opacity = enabled ? \"o-100\" : \"o-50 strike\";\r\n\r\n\t\tfunction getLabel(label) {\r\n\t\t\treturn label.replace(\"-\", \" \");\r\n\t\t}\r\n\r\n\t\t// Hack to change omni color based on backbone filter\r\n\t\tfunction getIcon(label) {\r\n\t\t\tif (label === \"omni\" && !filters.backbone) return icons.active;\r\n\t\t\tif (label === \"remote\" && filters.backbone) return icons.remote;\r\n\t\t\treturn icons[label];\r\n\t\t}\r\n\r\n\t\tfunction getColor(label) {\r\n\t\t\tif (label === \"omni\" && !filters.backbone) return nodeColors.active;\r\n\t\t\treturn nodeColors[label];\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tkey={label}\r\n\t\t\t\tclassName={`w-auto-ns w-50 pointer flex items-center justify-between ${opacity}`}\r\n\t\t\t\tonClick={() => toggleFilter(label)}\r\n\t\t\t>\r\n\t\t\t\t<label\r\n\t\t\t\t\thtmlFor={label}\r\n\t\t\t\t\tstyle={{ color: getColor(label) }}\r\n\t\t\t\t\tclassName=\"ttc pointer flex items-center nowrap\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tmarginLeft: \"-0.5rem\",\r\n\t\t\t\t\t\t\tmarginRight: \"-0.25rem\",\r\n\t\t\t\t\t\t\tmarginTop: \"-0.125rem\",\r\n\t\t\t\t\t\t\tmarginBottom: \"-0.125rem\"\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName=\"h2 w2 flex items-center justify-center\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{getIcon(label)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<span className=\"ml1\">\r\n\t\t\t\t\t\t{getLabel(label)}{\" \"}\r\n\t\t\t\t\t\t{hideCount ? null : `(${statusCounts[label] || 0})`}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</label>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\tname={label}\r\n\t\t\t\t\tdefaultChecked={enabled}\r\n\t\t\t\t\tclassName=\"ma0 ml2 dn\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport PureFilters from \"./component\";\r\n\r\nimport { toggleFilter } from \"../../actions\";\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tfilters: state.filters,\r\n\tstatusCounts: state.statusCounts,\r\n\tshowFilters: state.showFilters\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => ({\r\n\ttoggleFilter: label => toggleFilter(label, dispatch)\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(PureFilters);\r\n","import React, { PureComponent } from \"react\";\r\n\r\nexport default class Stats extends PureComponent {\r\n\trender() {\r\n\t\tconst { statusCounts, filters } = this.props;\r\n\t\tif (!statusCounts) return null;\r\n\t\tconst {\r\n\t\t\tactive = 0,\r\n\t\t\thub = 0,\r\n\t\t\tsupernode = 0,\r\n\t\t\tomni = 0,\r\n\t\t\tremote = 0,\r\n\t\t\tkiosk = 0\r\n\t\t} = statusCounts;\r\n\t\tconst totalCount = filters.backbone\r\n\t\t\t? active + hub + supernode + omni\r\n\t\t\t: active + hub + supernode + omni + remote + kiosk;\r\n\t\tconst nodeCount = filters.backbone\r\n\t\t\t? active\r\n\t\t\t: active + omni + remote + kiosk;\r\n\t\tconst hubCount = filters.backbone ? hub + omni : hub;\r\n\t\treturn (\r\n\t\t\t<div className=\"ph3 bg-white\">\r\n\t\t\t\t<div className=\"measure-wide center pt4-ns pb3-ns pt3\">\r\n\t\t\t\t\t<div className=\"flex flex-wrap justify-between f3 fw6\">\r\n\t\t\t\t\t\t<span className=\"mr3 mb3\">\r\n\t\t\t\t\t\t\t{totalCount}{\" \"}\r\n\t\t\t\t\t\t\t<span className=\"mid-gray db f4 fw5\">Total</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span className=\"mr3 mb3 pink\">\r\n\t\t\t\t\t\t\t{nodeCount}{\" \"}\r\n\t\t\t\t\t\t\t<span className=\"mid-gray db f4 fw5\">Nodes</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span className=\"mr3 mb3 light-blue\">\r\n\t\t\t\t\t\t\t{hubCount}{\" \"}\r\n\t\t\t\t\t\t\t<span className=\"mid-gray db f4 fw5\">Hubs</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span className=\"mr3 mb3 blue\">\r\n\t\t\t\t\t\t\t{supernode}{\" \"}\r\n\t\t\t\t\t\t\t<span className=\"mid-gray db f4 fw5\">\r\n\t\t\t\t\t\t\t\tSupernodes\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport PureComponent from \"./component\";\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tstatusCounts: state.statusCounts,\r\n\tfilters: state.filters\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(PureComponent);\r\n","import React, { PureComponent } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { format } from \"date-fns\";\r\nimport { icons } from \"../NodeName\";\r\n\r\nexport default class Log extends PureComponent {\r\n\tstate = {\r\n\t\tlimit: 3\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { links } = this.props;\r\n\t\tconst { limit } = this.state;\r\n\r\n\t\tconst sortedLinks = links\r\n\t\t\t.filter(link => link.status === \"active\" && link.installDate)\r\n\t\t\t.sort((a, b) => new Date(b.installDate) - new Date(a.installDate));\r\n\r\n\t\tlinks.forEach(link => {\r\n\t\t\tif (link.status === \"active\" && (!link.fromNode || !link.toNode)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfunction renderHorizontalLink(link) {\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<div className=\"ml2 mr3 w2 flex flex-column items-center justify-center\">\r\n\t\t\t\t\t\t<span className=\"flex items-center justify-center\">\r\n\t\t\t\t\t\t\t{icons[link.fromNode.type]}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName=\"bg-blue h1\"\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\twidth: \"0.2rem\"\r\n\t\t\t\t\t\t\t\t// marginTop: \"-0.25rem\"\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<span className=\"flex items-center justify-center\">\r\n\t\t\t\t\t\t\t{icons[link.toNode.type]}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"\">\r\n\t\t\t\t\t\t<time className=\"f6 fw5 mid-gray mb1 db\">\r\n\t\t\t\t\t\t\t{format(link.installDate, \"ddd, MMM D\")}\r\n\t\t\t\t\t\t</time>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t<span className=\"fw6\">\r\n\t\t\t\t\t\t\t\t\t{link.fromNode.name || `Node ${link.from}`}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<span className=\"mid-gray\"> connected to </span>\r\n\t\t\t\t\t\t\t\t<span className=\"fw6\">\r\n\t\t\t\t\t\t\t\t\t{link.toNode.name || `Node ${link.to}`}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"ph3 pb3 bg-white\">\r\n\t\t\t\t<div className=\"measure-wide center\">\r\n\t\t\t\t\t{sortedLinks.slice(0, limit).map(link => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tkey={`${link.from} ${link.to}`}\r\n\t\t\t\t\t\t\t\tto={`/nodes/${link.from}-${link.to}`}\r\n\t\t\t\t\t\t\t\tonClick={event => {\r\n\t\t\t\t\t\t\t\t\twindow.scroll(0, 0);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tclassName=\"db pv3 bb b--light-gray no-underline black hover-bg-near-white\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{renderHorizontalLink(link)}\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t\t{limit < sortedLinks.length ? (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"mt4 center bg-transparent bn pa0 blue pointer\"\r\n\t\t\t\t\t\t\tonClick={() => this.setState({ limit: limit * 2 })}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tShow more\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t) : null}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport PureComponent from \"./component\";\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n\tnodes: state.nodes,\r\n\tlinks: state.links,\r\n\tsectors: state.sectors,\r\n\tnodesById: state.nodesById,\r\n\tstatusCounts: state.statusCounts,\r\n\tfilters: state.filters\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(PureComponent);\r\n","import { nodeType, nodeStatus, linkStatus } from \"../utils\";\r\n\r\nimport {sheetsNodeData, sheetsNodeDataSeattle} from '../constants/spreadsheet_endpoints';\r\n// const sheetsNodeData = 'https://spreadsheets.google.com/feeds/cells/1FnKRPuEP2e1RIPwGmR1Ne153A_znaU3CzISDG52F-_Y/1/public/full?alt=json';\r\n// const sheetsLinksData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQZky64G3ynxhwh5QXZ3JLTPFXZ6-XTJmgz96ocdDwsbVIYjIqb0QDL8hxRGyq_Sl22sXbPh1bmFJY9/pubhtml';\r\n// const sheetsSectorData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRoIfkaY0NUUW6z4nIIVIwufpYMBR2lYzETKSdkLfiuHm34eokO7URgegOoX5tmIKmUvQMXcmH46qSV/pubhtml';\r\n// const kioskData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQJUXClGCrv8AaD68M1hOgHB3p2si7fmpTM8-dPhbOpvd7l0M0I6zJ47YTdhgY4EoWtQHlIIv9FA2ln/pubhtml';\r\n\r\n// check feed, and then entry inside json result. each entry in array should look like below:\r\n\r\n//category: [{scheme: \"http://schemas.google.com/spreadsheets/2006\",…}]\r\n// content: {type: \"text\", $t: \"a\"}\r\n// gs$cell: {row: \"1\", col: \"1\", inputValue: \"a\", $t: \"a\"}\r\n// id: {,…}\r\n// link: [{rel: \"self\", type: \"application/atom+xml\",…}]\r\n// title: {type: \"text\", $t: \"A1\"}\r\n// $t: \"A1\"\r\n// type: \"text\"\r\n// updated: {$t: \"2021-05-12T22:27:31.991Z\"}\r\n\r\n//parsed object should be:\r\n// {\r\n//     \"id\": 2,\r\n//     \"status\": \"Installed\",\r\n//     \"coordinates\": [\r\n//       -73.99110519999999,\r\n//       40.7123462,\r\n//       74\r\n//     ],\r\n//     \"requestDate\": 1426436311615,\r\n//     \"installDate\": 1513486800000,\r\n//     \"roofAccess\": false,\r\n//     \"notes\": \"Peter\",\r\n//     \"panoramas\": [\r\n//       \"2.jpg\"\r\n//     ]\r\n//   },\r\n\r\n\r\nimport nodeData from \"../data/nodes\";\r\nimport linkData from \"../data/links\";\r\nimport sectorData from \"../data/sectors\";\r\nimport kiosks from \"../data/kiosks\";\r\n\r\nconst initialFilters = {\r\n\tremote: true,\r\n\tlinkNYC: false,\r\n\tpotential: false,\r\n\tdead: false,\r\n\t\"potential-hub\": true,\r\n\t\"potential-supernode\": true,\r\n\tsector: true,\r\n\tbackbone: false,\r\n\tchangelog: false\r\n};\r\n\r\n// const { nodes, links, sectors, nodesById } = addGraphData(\r\n// \tnodeData,\r\n// \tlinkData,\r\n// \tsectorData\r\n// );\r\n\r\nasync function processEntry(entity) {\r\n//\tif(entity[0].isArray) {\r\n\tlet flattened = entity.flat(4);\r\n\r\n\t\treturn flattened;\r\n\r\n}\r\n\r\nasync function populateSpreadsheet () {\r\n\r\n\treturn fetch(sheetsNodeDataSeattle)\r\n\t\t.then(res => res.json())\r\n\t\t.then(json => processEntry(json.feed.entry))\r\n\t\t.then(jsonEntries => {\r\n\t\t\tconsole.log(\"success: \", jsonEntries);\r\n\t\t//\tconst jsonEntries = await(processEntry(json.feed.entry));\r\n\r\n\t\t\t// let NYCrowMap = {\r\n\t\t\t// \t1: \"id\",\r\n\t\t\t// \t2: \"name\",\r\n\t\t\t// \t3: \"status\",\r\n\t\t\t// \t4: \"coordinates\",\r\n\t\t\t// \t5: \"requestDate\",\r\n\t\t\t// \t6: \"installDate\",\r\n\t\t\t// \t7: \"roofAccess\",\r\n\t\t\t// \t8: \"notes\",\r\n\t\t\t// \t9: \"panoramas\"\r\n\t\t\t// };\r\n\t\t\tlet rowMap = {\r\n\t\t\t\t1: \"id\",\r\n\t\t\t\t2: \"name\",\r\n\t\t\t\t3: \"lng\",\r\n\t\t\t\t4: \"lat\",\r\n\t\t\t\t5: \"status\",\r\n\t\t\t\t6: \"notes\"\r\n\t\t\t}\r\n\r\n\t\t//\tlet counter = 0;\r\n\t\t\tlet formattedEntry = {};\r\n\t\t\tlet formattedEntries = [];\r\n\r\n\t\t\t// jsonEntries.forEach((entryItem, index)=> {\r\n\t\t\t// \tformattedEntry[rowMap[entryItem.gs$cell.col]] = entryItem.content.$t;\r\n\t\t\t// });\r\n\r\n\t\t\tfor(var i = 0; i < jsonEntries.length; i++) {\r\n\t\t\t\tlet entry = jsonEntries[i];\r\n\t\t\t\tlet column = entry.gs$cell.col;\r\n\t\t\t\tlet content = entry.content.$t;\r\n\t\t\t\t// if(entry.gs$cell.col == 4) {\r\n\t\t\t\t// \tentry.content.$t = entry.content.$t.split(',').map(str => parseFloat(str));\r\n\t\t\t\t// \tconsole.log(\"ENTRY COORDS: \", entry);\r\n\t\t\t\t// }\r\n\t\t\t\tlet newStatus = '';\r\n\t\t\t\tif(column == 5) {\r\n\t\t\t\t\tif(content == \"confirmed\" || content == \"active\") {\r\n\t\t\t\t\t  newStatus = \"Installed\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (content == \"in-conversation\") {\r\n\t\t\t\t\t  newStatus = \"Interested\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t  content = newStatus;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( column == 6) {\r\n\t\t\t\t\t// content += \" hub\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(column == 3) {\r\n\t\t\t\t\tformattedEntry[\"coordinates\"] = [parseFloat(content)];\r\n\t\t\t\t} else if (column == 4) {\r\n\t\t\t\t\tformattedEntry[\"coordinates\"].unshift(parseFloat(content));\r\n\t\t\t\t\tformattedEntry[\"coordinates\"].push(1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tformattedEntry[rowMap[column]] = content;\r\n\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\t//if(jsonEntries[i].gs$cell.col == 9) {\r\n\t\t\t\tif(column == 6) {\r\n\r\n\t\t\t\t\tformattedEntry.requestDate = Date.now();\r\n\t\t\t\t\tformattedEntry.installDate = Date.now();\r\n\r\n\t\t\t\t//\tformattedEntry[\"status\"] = \"active\";\r\n\r\n\t\t\t\t\tconsole.log(\"formatted entry!: \", formattedEntry);\r\n\t\t\t\t    formattedEntries.push(formattedEntry);\r\n\t\t\t\t\tformattedEntry = {};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconsole.log(\"formatted .... \", formattedEntries);\r\n\t\t\treturn formattedEntries;\r\n\t\t})\r\n\t\t.catch(err => {\r\n\t\t\treturn err;\r\n\t\t\tconsole.log(err)}\r\n\t\t);\r\n\r\n}\r\n\r\n// const reducerWrapper = (customNodes) => {\r\n// \tlet nodes = await populateSpreadsheet();\r\n\t\r\n// }\r\n\r\nconst reducerInit = async () => {\r\n\tconst nodeData = await populateSpreadsheet();\r\n\tconsole.log(\"node data.. \", nodeData);\r\n\tconst { nodes, links, sectors, nodesById } = addGraphData(\r\n\t\tnodeData,\r\n\t\tlinkData,\r\n\t\tsectorData\r\n\t);\r\n\t\r\n\t//custom_nodes = nodes;\r\n\treturn (\r\n\t\tstate = {\r\n\t\t\tnodes,\r\n\t\t\tlinks,\r\n\t\t\tsectors,\r\n\t\t\tkiosks: initialFilters.linkNYC === false ? [] : kiosks,\r\n\t\t\tnodesById,\r\n\t\t\tfilters: initialFilters,\r\n\t\t\tstatusCounts: getCounts(nodeData, kiosks),\r\n\t\t\tshowFilters: false\r\n\t\t},\r\n\t\taction\r\n\t) => {\r\n\t\tswitch (action.type) {\r\n\t\t\tcase \"TOGGLE_FILTER\":\r\n\t\t\t\tconst newFilters = {\r\n\t\t\t\t\t...state.filters,\r\n\t\t\t\t\t[action.label]:\r\n\t\t\t\t\t\tstate.filters[action.label] === undefined\r\n\t\t\t\t\t\t\t? false\r\n\t\t\t\t\t\t\t: !state.filters[action.label]\r\n\t\t\t\t};\r\n\t\t\t\tif (action.label === \"potential\") {\r\n\t\t\t\t\tconst hasValue = state.filters[\"potential\"] === undefined;\r\n\t\t\t\t\tconst newValue = hasValue ? false : !state.filters[\"potential\"];\r\n\t\t\t\t\tnewFilters[\"dead\"] = newValue;\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tfilters: newFilters,\r\n\t\t\t\t\tkiosks: newFilters.linkNYC === false ? [] : kiosks\r\n\t\t\t\t};\r\n\t\t\tcase \"TOGGLE_FILTERS\":\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tshowFilters: !state.showFilters\r\n\t\t\t\t};\r\n\t\r\n\t\t\tdefault:\r\n\t\t\t\treturn state;\r\n\t\t}\r\n\t};\r\n\r\n}\r\n\r\n\r\n// TODO: Calculate a lot of this in node-db\r\nfunction addGraphData(nodes, links, sectors) {\r\n\tconst _remoteSheet = true;\r\n\r\n\r\n\tconst nodesById = {};\r\n\r\n\tconst linksByNodeId = {};\r\n\tlinks.forEach(link => {\r\n\t\tlinksByNodeId[link.from] = linksByNodeId[link.from] || [];\r\n\t\tlinksByNodeId[link.to] = linksByNodeId[link.to] || [];\r\n\t\tlinksByNodeId[link.from].push(link);\r\n\t\tlinksByNodeId[link.to].push(link);\r\n\t});\r\n\r\n\t// Group nodes at same lat / lng\r\n\tconst mergedNodes = {};\r\n\r\n\t// Add status, types and links to nodes\r\n\tnodes.forEach(node => {\r\n\t\tif (node.notes) {\r\n\t\t\tnode.notes = String(node.notes);\r\n\t\t}\r\n\t\tnodesById[node.id] = node;\r\n\t\tnode.links = linksByNodeId[node.id];\r\n\t\tnode.status = nodeStatus(node);\r\n\t\tconst key = geoKey(node);\r\n\t\tmergedNodes[key] = mergedNodes[key] || [];\r\n\t\tmergedNodes[key].push(node);\r\n\t});\r\n\r\n\t// Add status and nodes to links\r\n\tlinks.forEach(link => {\r\n\t\tlink.fromNode = nodesById[link.from];\r\n\t\tlink.toNode = nodesById[link.to];\r\n\t\tlink.status = linkStatus(link);\r\n\t});\r\n\r\n\t// Add sectors to nodes\r\n\tconst sectorsByNodeId = {};\r\n\tsectors.forEach(sector => {\r\n\t\tsector.node = nodesById[sector.nodeId];\r\n\t\tsectorsByNodeId[sector.nodeId] = sectorsByNodeId[sector.nodeId] || [];\r\n\t\tsectorsByNodeId[sector.nodeId].push(sector);\r\n\t});\r\n\r\n\tnodes.forEach(node => {\r\n\t\tnode.sectors = sectorsByNodeId[node.id];\r\n\r\n\t\t// Calculate connected nodes for each active node\r\n\t\tconst connectedNodes = [node.id];\r\n\r\n\t\tlinks.forEach(link => {\r\n\t\t\tif (link.from === parseInt(node.id, 10)) {\r\n\t\t\t\tconnectedNodes.push(link.to);\r\n\t\t\t}\r\n\r\n\t\t\tif (link.to === parseInt(node.id, 10)) {\r\n\t\t\t\tconnectedNodes.push(link.from);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tnode.connectedNodes = connectedNodes;\r\n\t\tnode.memberNodes = mergedNodes[geoKey(node)];\r\n\r\n\t\tnode.type = nodeType(node);\r\n\t\tnodesById[node.id] = node;\r\n\t});\r\n\r\n\treturn { nodes, links, sectors, nodesById };\r\n}\r\n\r\nfunction getCounts(nodes, kiosks) {\r\n\tconst counts = {};\r\n\tnodes.forEach(node => {\r\n\t\tconst { type } = node;\r\n\t\tcounts[type] = (counts[type] || 0) + 1;\r\n\r\n\t\tif (node.sectors) {\r\n\t\t\tcounts[\"sector\"] = (counts[\"sector\"] || 0) + node.sectors.length;\r\n\t\t}\r\n\t});\r\n\tcounts.linkNYC = kiosks.length;\r\n\treturn counts;\r\n}\r\n\r\nfunction geoKey(node) {\r\n\tconst precision = 5;\r\n\tconst [lat, lng] = node.coordinates;\r\n\tconst key = lat.toFixed(precision) + \"-\" + lng.toFixed(precision);\r\n\treturn key;\r\n}\r\n\r\nexport default reducerInit;\r\n","import { createStore } from \"redux\";\r\nimport { Provider } from \"react-redux\";\r\nimport DocumentTitle from \"react-document-title\";\r\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\r\n\r\nimport React, { Component } from \"react\";\r\nimport SearchBar from \"./components/SearchBar\";\r\nimport MapView from \"./components/MapView\";\r\nimport Filters from \"./components/Filters\";\r\nimport Stats from \"./components/Stats\";\r\nimport Log from \"./components/Log\";\r\n\r\n// import {reducer, reducerInit} from \"./reducers\";\r\nimport reducerInit from './reducers';\r\n// const _reducer = reducerInit(); \r\n// console.log(\"_reducer:\", _reducer);\r\nlet store = {};\r\n\r\nfunction StoreLoaded ({store}) {\r\n\t//console.log(\"loaded store val: \", store);\r\n\tif(store != undefined) {\r\n\t\treturn (\r\n\t\t\t<Provider store={store}>\r\n\t\t\t<Router basename=\"/map\">\r\n\t\t\t\t<div className=\"helvetica\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tid=\"map-stats-container\"\r\n\t\t\t\t\t\tclassName=\"h-100 w-100 flex flex-column\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"h-100 w-100 relative flex flex-column\">\r\n\t\t\t\t\t\t\t<div className=\"absolute pa2 z-999 search-bar\">\r\n\t\t\t\t\t\t\t\t<SearchBar />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath=\"/nodes/:nodeId\"\r\n\t\t\t\t\t\t\t\tchildren={({ match }) => (\r\n\t\t\t\t\t\t\t\t\t<MapView match={match} />\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div className=\"absolute bottom-0 left-0 ma2\">\r\n\t\t\t\t\t\t\t\t<Route component={Filters} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Route path=\"/\" component={Stats} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Route path=\"/\" component={Log} />\r\n\t\t\t\t</div>\r\n\t\t\t</Router>\r\n\t\t</Provider>\r\n\t\t);\r\n\t}\r\n\telse {\r\n\t\treturn (<div><p>loading map...</p></div>);\r\n\t}\r\n}\r\n\r\nclass App extends Component {\r\n\r\n\t// storeLoaded() {\r\n\t// \tif(this.store != undefined) {\r\n\t// \t\treturn (\r\n\t// \t\t\t<Provider store={this.store}>\r\n\t// \t\t\t<Router basename=\"/map\">\r\n\t// \t\t\t\t<div className=\"helvetica\">\r\n\t// \t\t\t\t\t<div\r\n\t// \t\t\t\t\t\tid=\"map-stats-container\"\r\n\t// \t\t\t\t\t\tclassName=\"h-100 w-100 flex flex-column\"\r\n\t// \t\t\t\t\t>\r\n\t// \t\t\t\t\t\t<div className=\"h-100 w-100 relative flex flex-column\">\r\n\t// \t\t\t\t\t\t\t<div className=\"absolute pa2 z-999 search-bar\">\r\n\t// \t\t\t\t\t\t\t\t<SearchBar />\r\n\t// \t\t\t\t\t\t\t</div>\r\n\t// \t\t\t\t\t\t\t<Route\r\n\t// \t\t\t\t\t\t\t\tpath=\"/nodes/:nodeId\"\r\n\t// \t\t\t\t\t\t\t\tchildren={({ match }) => (\r\n\t// \t\t\t\t\t\t\t\t\t<MapView match={match} />\r\n\t// \t\t\t\t\t\t\t\t)}\r\n\t// \t\t\t\t\t\t\t/>\r\n\t// \t\t\t\t\t\t\t<div className=\"absolute bottom-0 left-0 ma2\">\r\n\t// \t\t\t\t\t\t\t\t<Route component={Filters} />\r\n\t// \t\t\t\t\t\t\t</div>\r\n\t// \t\t\t\t\t\t</div>\r\n\t// \t\t\t\t\t\t<Route path=\"/\" component={Stats} />\r\n\t// \t\t\t\t\t</div>\r\n\t// \t\t\t\t\t<Route path=\"/\" component={Log} />\r\n\t// \t\t\t\t</div>\r\n\t// \t\t\t</Router>\r\n\t// \t\t</Provider>\r\n\t// \t\t);\r\n\t// \t} else {\r\n\t// \t\treturn (<div><p>loading map...</p></div>);\r\n\t// \t}\r\n\t// }\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.state = {store: undefined};\r\n\t}\r\n\tasync componentWillMount() {\r\n\t\t//this.store = undefined;\r\n\t\tconst reducer = await reducerInit();\r\n\t\t//this.store = createStore(reducer);\r\n\t\tthis.setState({store: createStore(reducer)});\r\n\t//\tconsole.log(\"store!!!: \", this.store);\r\n\t}\r\n\r\n\trender() {\r\n\t\t\treturn (\r\n\t\t\t\t<DocumentTitle title=\"Map - Seattle Mesh\">\r\n\t\t\t\t\t<StoreLoaded store={this.state.store}/>\r\n\t\t\t\t</DocumentTitle>\r\n\t\t\t);\r\n\t//\t}\r\n\r\n\t}\r\n\r\n\thandleNodeClick(node) {}\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n//if (process.env.NODE_ENV === \"development\") {\r\n\trequire(\"tachyons\");\r\n//\trequire(\"./index.css\");\r\n//} else {\r\n\trequire(\"./index.css\");\r\n//}\r\n\r\nReactDOM.render(<App />, document.getElementById(\"map-root\"));\r\n"],"sourceRoot":""}